name: JSON Schema Validation

on:
  push:
    branches: [ main, develop ]
  pull_request:
    branches: [ main, develop ]

jobs:
  validate-json:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
      
    - name: Install sourcemeta json schema cli
      uses: sourcemeta/jsonschema@main
        
    - name: Lint JSON files
      run: |
        echo "Linting JSON files..."
        set -e  # Exit on any error
        echo "Linting softbinding-algorithm-list.json..."
        jsonschema lint softbinding-algorithm-list.json
        echo "✓ softbinding-algorithm-list.json passed linting"
        
        echo "Linting softbinding-algorithm-entry-schema.json..."
        jsonschema lint softbinding-algorithm-entry-schema.json
        echo "✓ softbinding-algorithm-entry-schema.json passed linting"
        
    - name: Validate against schema
      run: |
        echo "Validating softbinding-algorithm-list.json against schema..."
        set -e  # Exit on any error
        jsonschema validate softbinding-algorithm-list.json --schema softbinding-algorithm-entry-schema.json
        echo "✓ softbinding-algorithm-list.json is valid against the schema"